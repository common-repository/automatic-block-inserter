!function(){"use strict";var e=window.wp.element,t=window.wp.i18n,o=window.wp.plugins,l=window.wp.data,n=window.wp.editPost;function a(){return a=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var o=arguments[t];for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(e[l]=o[l])}return e},a.apply(this,arguments)}var c=window.lodash,r=window.wp.components,i=function(){return"true"===(0,c.get)(window,"automaticBlockInserter.isPremium","false")},s=window.React,u=window.wp.primitives,p=(0,e.createElement)(u.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"},(0,e.createElement)(u.Path,{d:"M19 8h-1V6h-5v2h-2V6H6v2H5c-1.1 0-2 .9-2 2v8c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2v-8c0-1.1-.9-2-2-2zm.5 10c0 .3-.2.5-.5.5H5c-.3 0-.5-.2-.5-.5v-8c0-.3.2-.5.5-.5h14c.3 0 .5.2.5.5v8z"})),m=window.wp.blockEditor,b=window.wp.blocks;const k=()=>(0,b.getBlockTypes)().filter((e=>!(!e.name.startsWith("core/")&&!i()))).map((e=>{var t;const o=e.name.split("/"),l=(0,c.head)(o);return{icon:null!==(t=e?.icon)&&void 0!==t?t:null,value:e.name,rawLabel:e.title,namespace:l,label:(0,c.head)(o)+": "+e.title}}));var d=function(o){const[l,n]=(0,s.useState)(""),a=k().filter((e=>{const t=-1!==e.label.toLowerCase().indexOf(l.toLowerCase());return""===l||t})),i=(0,c.groupBy)(a,"namespace"),u=a.length>0;return(0,e.createElement)("div",{className:"abi-block-type-search-control"},(0,e.createElement)(r.BaseControl,{label:(0,t.__)("Block Type","automatic-block-inserter")},(0,e.createElement)(r.SearchControl,{value:l,onChange:n,placeholder:(0,t.__)("Search Block Type","automatic-block-inserter")})),u?(0,e.createElement)("div",{className:"abi-block-type-search-control-blocks"},Object.keys(i).map(((t,l)=>{const n=i[t];return(0,e.createElement)(r.MenuGroup,{label:t,key:l},n.map(((t,l)=>{const n=t.value===o.value,a=(0,c.get)(t.icon,"src",null),i=(0,c.isFunction)(a)||(0,s.isValidElement)(a);return(0,e.createElement)(r.MenuItem,{key:l,iconPosition:"left",isPressed:n,icon:i?(0,e.createElement)(m.BlockIcon,{icon:a}):p,onClick:()=>o.onChange(t.value)},t.rawLabel)})))}))):(0,e.createElement)("div",{className:"abi-block-type-search-control-no-result"},(0,e.createElement)("p",null,(0,t.__)("No blocks found.","automatic-block-inserter"))))},w=function(o){const l={locationType:"post",placement:"before",location:"post-content",offset:1,allowNested:!0},[n,s]=(0,e.useState)((()=>(0,c.isEmpty)(o?.value)?l:{...l,...o.value}));(0,e.useEffect)((()=>{o.onChange(n)}),[n]);const u=i(),p=(0,c.get)(window,"automaticBlockInserter.supportedPostTypes",[]).map((e=>({value:e,label:e}))),m=[{value:"post-content",label:(0,t.__)("Post Content","automatic-block-inserter")}],b=[{value:"before",label:(0,t.__)("Before","automatic-block-inserter")},{value:"after",label:(0,t.__)("After","automatic-block-inserter")}],w=[{value:"post",label:(0,t.__)("Post Area","automatic-block-inserter")},{value:"block",label:(0,t.__)("Block","automatic-block-inserter")}],h=(0,t.sprintf)((0,t.__)('This block will be inserted "%s" the %s below.',"automatic-block-inserter"),n.placement,"block"===n.locationType?(0,t.__)("selected block type","automatic-block-inserter"):(0,t.__)("selected post area","automatic-block-inserter")),_=(0,c.get)(m,[0,"value"]),v=(0,c.get)(k(),[0,"value"]),g=(0,c.get)(n,"postType",""),f=n.offset>0;return(0,e.createElement)(e.Fragment,null,(0,e.createElement)(r.SelectControl,{options:[{label:(0,t.__)("All Post Types","automatic-block-inserter"),value:""},...p],value:g,onChange:e=>s({...n,postType:e}),label:(0,t.__)("Post Type","automatic-block-inserter"),help:(0,t.__)("Select a post type where this block should be displayed according to your selected position below.","automatic-block-inserter")}),(0,e.createElement)(r.__experimentalToggleGroupControl,{isBlock:!0,label:(0,t.__)("Location Type"),help:h,onChange:e=>{const t={...n,locationType:e,location:"block"===e?v:_};s(t)},value:n.locationType},w.map(((t,o)=>(0,e.createElement)(r.__experimentalToggleGroupControlOption,{key:o,value:t.value,label:t.label})))),(0,e.createElement)(r.SelectControl,{options:b,value:n.placement,onChange:e=>s({...n,placement:e}),label:(0,t.__)("Placement","automatic-block-inserter"),help:(0,t.__)("Select a placement of the content.","automatic-block-inserter")}),"block"===n.locationType?(0,e.createElement)(e.Fragment,null,(0,e.createElement)(d,{value:n.location,onChange:e=>{s({...n,location:e})}}),(0,e.createElement)("br",null),(0,e.createElement)(r.TextControl,a({type:"number",value:n.offset,label:(0,t.__)("Offset","automatic-block-inserter"),help:f?(0,t.sprintf)((0,t.__)("This block will be inserted %s the %d selected block type on the page.","automatic-block-inserter"),n.placement,n.offset):(0,t.sprintf)((0,t.__)("This block will be inserted %s the %d last selected block type on the page from the bottom.","automatic-block-inserter"),n.placement,Math.abs(n.offset)),onChange:e=>{const t=Number(e),o=f?-1:1;s({...n,offset:0===t?o:t})}},!u&&{min:1})),u&&(0,e.createElement)(r.ToggleControl,{label:(0,t.__)("Top Level Blocks","automatic-block-inserter"),checked:!n.allowNested,onChange:()=>s({...n,allowNested:!n.allowNested}),help:(0,t.__)("Enabling this will limit block insertion to non-nested blocks. Any blocks within another block, such as a group, will not be considered.","automatic-block-inserter")})):(0,e.createElement)(r.SelectControl,{options:m,value:n.location,onChange:e=>s({...n,location:e}),label:(0,t.__)("Select Post Area","automatic-block-inserter")}))};const h="automatic-block-position";(0,o.registerPlugin)("automatic-block-inserter-positions",{render:()=>{const{position:o}=(0,l.useSelect)((e=>{const t=e("core/editor").getEditedPostAttribute("meta");return{position:JSON.parse(t[h])}}),[]),{editPost:a}=(0,l.useDispatch)("core/editor");return(0,e.createElement)(n.PluginDocumentSettingPanel,{name:"automatic-block-inserter-positions",title:(0,t.__)("Position","automatic-block-inserter")},(0,e.createElement)(w,{value:o,onChange:e=>a({meta:{[h]:JSON.stringify(e)}})}))}})}();